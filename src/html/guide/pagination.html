<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>손기연 | 페이지네이션</title>
  <link rel="stylesheet" href="../../css/common.css">
</head>

<body>
  <div class="wrapper">
    <!-- ### 헤더 ### -->
    <header class="header"></header>

    <!-- ### 메인 ### -->
    <main class="container">
      <!-- 가이드 -->
      <nav class="guide-nav"></nav>
      <!-- 포폴 -->
      <section class="main-section">
        <h3 class="tit-main" data-text="Pagination">Pagination</h3>

        <style>
          .commentWrap {
            padding: 7px 10px;
            text-align: left;
          }

          .commentWrap img {
            vertical-align: middle;
            margin-right: 10px;
            border-radius: 50%;
            width: 50px;
            height: 50px;
          }

          .commentWrap .createdAt {
            float: right;
            vertical-align: middle;
          }

          .commentWrap .content {
            margin: 10px 0;
          }

          .pageWrap {
            margin-bottom: 20px;
            text-align: center;
          }

          .pageWrap button {
            padding: 0.375rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 1rem;
            line-height: 1.5;
            border: 1px solid lightgray;
            margin-right: 3px;
            color: #fff;
          }

          .pageWrap button.active {
            background: gray;
            color: #fff;
          }
        </style>
        <div>
          <div id="commentContainer"></div>
          <div id="pageContainer" class="pageWrap"></div>
        </div>

        <script>
          // JSON
          var comments = [{
              id: 1,
              profile_url: "https://picsum.photos/id/1/50/50",
              author: "abc_1",
              content: "UI 테스트는 어떻게 진행하나요",
              createdAt: "2021-02-01",
            },
            {
              id: 2,
              profile_url: "https://picsum.photos/id/2/50/50",
              author: "abc_2",
              content: "막히면 대답은 빨리 해주나요",
              createdAt: "2021-02-02",
            },
            {
              id: 3,
              profile_url: "https://picsum.photos/id/3/50/50",
              author: "abc_3",
              content: "코드에러가 발생했는데 어딘지 모르겠어요",
              createdAt: "2021-02-03",
            },
            {
              id: 4,
              profile_url: "https://picsum.photos/id/4/50/50",
              author: "abc_4",
              content: "Javascript 기초가 부족한데 좋은 가이드 있나요",
              createdAt: "2021-02-04",
            },
            {
              id: 5,
              profile_url: "https://picsum.photos/id/5/50/50",
              author: "abc_5",
              content: "Typescript는 어떤점에서 좋나요",
              createdAt: "2021-02-05",
            },
            {
              id: 6,
              profile_url: "https://picsum.photos/id/6/50/50",
              author: "abc_6",
              content: "React 소스 배포는 보통 어떤식으로 하나요.",
              createdAt: "2021-02-06",
            },
            {
              id: 7,
              profile_url: "https://picsum.photos/id/7/50/50",
              author: "abc_7",
              content: "주변에 React 개발자 있나요",
              createdAt: "2021-02-07",
            },
            {
              id: 8,
              profile_url: "https://picsum.photos/id/8/50/50",
              author: "abc_8",
              content: "Typescript 배워 보려고 합니다. 어떻게 배우는게 빠를까요",
              createdAt: "2021-02-08",
            },
            {
              id: 9,
              profile_url: "https://picsum.photos/id/9/50/50",
              author: "abc_9",
              content: "컴포넌트 테스트는 어떻게 하나요.",
              createdAt: "2021-02-09",
            },
            {
              id: 10,
              profile_url: "https://picsum.photos/id/10/50/50",
              author: "abc_10",
              content: "storybook은 무엇인가요.",
              createdAt: "2021-02-10",
            },
            {
              id: 11,
              profile_url: "https://picsum.photos/id/11/50/50",
              author: "abc_11",
              content: "주변에 React 개발자 있나요",
              createdAt: "2021-02-11",
            },
            {
              id: 12,
              profile_url: "https://picsum.photos/id/12/50/50",
              author: "abc_12",
              content: "주변에 React 개발자 있나요",
              createdAt: "2021-02-12",
            },
            {
              id: 13,
              profile_url: "https://picsum.photos/id/13/50/50",
              author: "abc_13",
              content: "주변에 React 개발자 있나요",
              createdAt: "2021-02-13",
            },
            {
              id: 14,
              profile_url: "https://picsum.photos/id/14/50/50",
              author: "abc_14",
              content: "Next.js 가이드 주세요.14",
              createdAt: "2021-02-14",
            },
            {
              id: 15,
              profile_url: "https://picsum.photos/id/15/50/50",
              author: "abc_15",
              content: "vue vs react 뭐가 좋나요.",
              createdAt: "2021-02-15",
            },
            {
              id: 16,
              profile_url: "https://picsum.photos/id/16/50/50",
              author: "abc_16",
              content: "Atomic 디자인은 무엇인가요",
              createdAt: "2021-02-16",
            },
            {
              id: 17,
              profile_url: "https://picsum.photos/id/18/50/50",
              author: "abc_17",
              content: "UI 테스트는 어떻게 진행하나요",
              createdAt: "2021-02-17",
            },
            {
              id: 18,
              profile_url: "https://picsum.photos/id/18/50/50",
              author: "abc_18",
              content: "local storage는 언제 사용하는게 좋나요.",
              createdAt: "2021-02-18",
            },
            {
              id: 19,
              profile_url: "https://picsum.photos/id/19/50/50",
              author: "abc_19",
              content: "막히면 대답은 빨리 해주나요",
              createdAt: "2021-02-19",
            },
            {
              id: 20,
              profile_url: "https://picsum.photos/id/20/50/50",
              author: "abc_20",
              content: "Form 처리는 어떻게 하면 깔끔할까요",
              createdAt: "2021-02-20",
            },
            {
              id: 21,
              profile_url: "https://picsum.photos/id/21/50/50",
              author: "abc_21",
              content: "typescript도 배워 보려고 합니다. 어떻게 배우는게 빠를까요",
              createdAt: "2021-02-21",
            },
            {
              id: 22,
              profile_url: "https://picsum.photos/id/22/50/50",
              author: "abc_22",
              content: "주변에 React 개발자 있나요",
              createdAt: "2021-02-22",
            },
          ];

          // 초기값 셋팅
          function Pagination() {
            this.current_page = 1;
            this.limit = 5;
            this.total_page = Math.ceil(comments.length / this.limit);
          }

          // 페이지 세팅
          Pagination.prototype.getComments = function (page) {
            var start = (page - 1) * this.limit;
            this.current_page = page;
            var limit = start + this.limit;

            // 아래와 같이 처리 하는 것은 배열의 인덱스가 시작지점부터 한페이지에 보여질 게시물 수의 인덱스로 처리하기 위함이다.
            return comments.filter(function (_, index) {
              if (index >= start && index < limit) return true;
              else return false;
            });
          };

          // 게시물 배열을 넘겼을 때 html 태그에 맞춰서 출력해주는 함수를 구현한다.
          Pagination.prototype.getCommentFormat = function (comments) {

            // 아래와 같이 처리 하는것은 html 양식에 맞춰 순회하면서 acc 에 누적해서 리턴해주기 위함이다.
            return comments.reduce(function (acc, comment) {
              return (
                acc +
                '<div class="commentWrap"><img src="' +
                comment.profile_url +
                '" alt="" />' +
                comment.author +
                '<div class="createdAt">' +
                comment.createdAt +
                '</div><div class="content">' +
                comment.content +'</div><hr /> </div>'
              );
            }, "");
          };

          // 총 페이지의 숫자를 입력시 페이지를 화면에 뿌려주는 함수를 구현한다.
          Pagination.prototype.getPageListFormat = function () {
            var result = "";

            for (var num = 1; num <= this.total_page; num++) {
              var className = num == this.current_page ? "active" : "";
              result += '<button class="' + className + '">' + num + "</button>";
            }

            return result;
          };

          document.addEventListener("DOMContentLoaded", function () {
            var pagination = new Pagination();

            var commentContainer = document.querySelector("#commentContainer");
            var pageContainer = document.querySelector("#pageContainer");

            commentContainer.innerHTML = pagination.getCommentFormat(
              pagination.getComments(1)
            );
            pageContainer.innerHTML = pagination.getPageListFormat();

            document.addEventListener("click", function (event) {
                // IE를 위함
                matches = event.target.matches ? event.target.matches('#pageContainer button') : event.target.msMatchesSelector('#pageContainer button');
                // 페이징 클릭 시
                if (matches) {
                  var page = event.target.innerHTML;
                  commentContainer.innerHTML = pagination.getCommentFormat(
                    pagination.getComments(page)
                  );
                  pageContainer.innerHTML = pagination.getPageListFormat();
                  return;
                }
              },
              false
            );
          });
        </script>

        <p class="codepen" data-height="400" data-theme-id="dark" data-default-tab="js,result" data-editable="true" data-user="Sonky" data-slug-hash="wvomBOa" style="height: 400px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Pagination">
          <span>See the Pen <a href="https://codepen.io/Sonky/pen/wvomBOa">
          Pagination</a> by Sonky (<a href="https://codepen.io/Sonky">@Sonky</a>)
          on <a href="https://codepen.io">CodePen</a>.</span>
        </p>
        
      </section>
    </main>
    <!-- ### // ### -->
  </div>
  
  <script src="../../js/common.js"></script>
  <script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>
</body>

</html>